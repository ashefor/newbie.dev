<div class="navcontainer">
  <nav class="navbar is-fixed-top is-white" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
      <a class="navbar-item is-size-3 is-uppercase" [routerLink]="['/home']" routerLinkActive="router-link-active">
        <!-- <img src="https://bulma.io/images/bulma-logo.png" width="112" height="28"> -->
        Newbie
      </a>

      <a role="button" class="navbar-burger burger" (click)="showMenu()" id="burger" aria-label="menu"
        aria-expanded="false" data-target="navbarBasicExample">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div id="navbarBasicExample" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" [routerLink]="['/create']" routerLinkActive="router-link-active">
          Write a post
        </a>
        <a class="navbar-item has-text-primary has-text-weight-semibold">
          Sign In
        </a>
        <div class="navbar-item">
          <a class="button is-primary is-outlined">
            Log in
          </a>
        </div>
      </div>
    </div>
  </nav>
</div>
<div class="section">
  <div class="post_wrapper">
    <div class="" *ngIf="showpost">
      <div class="">
        <div class="field p_a">
          <div class="media">
            <div class="media-left">
              <figure class="image is-48x48">
                <img src="https://bulma.io/images/placeholders/96x96.png" alt="Placeholder image" class="is-rounded">
              </figure>
            </div>
            <div class="media-content">
              <p class="title is-size-6 has-text-weight-normal">{{post.author}}</p>
              <p class="subtitle is-size-6 has-text-weight-normal">{{post.date | date}} . <span>{{result}} min
                  read</span></p>
            </div>
            <div class="media-right">
              <div class="buttons">
                <a class="button is-primary is-outlined" title="Edit" routerLink="/{{post._id}}/edit">
                  <i class="fas fa-edit"></i>
                </a>
                <a class="button is-danger is-outlined" (click)="deleteThisPost(post)">
                  <i class="fas fa-trash"></i>
                </a>
              </div>
            </div>
          </div>
        </div>
        <div class="field p_t">
          <p class="title is-size-2 has-text-weight-normal">
            {{post.title}}
          </p>
          <div class="tags">
            <span class="tag" *ngFor="let tags of alltags">
              {{tags}}
            </span>
          </div>
        </div>
        <div class="body-text content">
          <div class="content texttrunc is-size-5 has-text-justified" [innerHTML]="post.body">
            <!-- {{post.body}} -->
          </div>
          <div class="field has-text-left-mobile has-text-right lp">
            <a class="icon is-size-4" (click)="likePost(post._id)">
              <span>
                <i class="fas fa-heart has-text-link" *ngIf="!hasLiked"></i>
                <i class="fas fa-heart has-text-danger" *ngIf="hasLiked"></i>
              </span>
              <span>
                {{nooflikes}}
              </span>
            </a>
          </div>
          <hr>
        </div>
        <div class="">
          <a class="button is-primary is-outlined is-fullwidth is-medium" (click)="toggleComment()">
            <p *ngIf="addComment">
              I change my mind
            </p>
            <p *ngIf="!addComment">
              Add a comment
            </p>
          </a>
          <div *ngIf="addComment" style="border: 2px solid" class="field c_w">
            <form [formGroup]="commentForm">
              <div class="control t_w">
                <ckeditor [editor]="Editor" formControlName="body" [config]="config"></ckeditor>
              </div>
              <div class="buttons is-right b_w">
                <span class="button is-info" (click)="addThisComment(post._id)">Submit</span>
              </div>
            </form>
          </div>
        </div>
        <div *ngFor="let comment of post.comments.reverse(); let index = y" class="d_c">

          <div *ngIf="comment == null; else showOtherComment">
            <div class="card s_c">
              <div class="card-content">
                <div class="control">
                  <input class="input" type="text" placeholder="comment unavailable" disabled>
                </div>
              </div>
            </div>
          </div>
          <ng-template #showOtherComment>
            <div class="card s_c">
              <div class="card-content">
                <div class="media">
                  <div class="media-left">
                    <figure class="image is-32x32">
                      <img src="https://bulma.io/images/placeholders/96x96.png" alt="Placeholder image"
                        class="is-rounded">
                    </figure>
                  </div>
                  <div class="media-content">
                    <div class="content">
                      <p class="has-text-weight-light is-size-6 c_a">{{comment.author? comment.author: 'Anonymous'}}</p>
                      <time datetime="" class="has-text-weight-light is-size-6">{{post.date | date : 'MMM dd'}}</time>
                      <!-- <p class="subtitle has-text-weight-light is-6">{{post.date | date : 'MMM dd'}}</p> -->
                    </div>
                  </div>
                  <div class="media-right">
                    <i class="fa fa-ellipsis-v"></i>
                  </div>
                </div>
                <div class="content" [innerHTML]="comment.body">

                </div>
                <div class="c_f">
                  <div class="level is-mobile">
                    <div class="level-left">
                      <div class="level-item">
                        <a>
                          <span class="icon">
                            <i class="fas fa-heart has-text-danger"></i>
                          </span>
                          <span>0</span>
                        </a>
                      </div>
                    </div>
                    <div class="level-right">
                      <div class="level-item">
                        <a (click)="deleteThisComment(post, comment)">
                          Delete
                        </a>
                      </div>
                      <div class="level-item">
                        <a (click)="editComment(comment._id)">
                          Edit
                        </a>
                      </div>
                      <div class="level-item">
                        <a (click)="replyComment(comment._id)">Reply</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div *ngIf="comment?._id === loadid">
                <ckeditor [editor]="Editor" [data]="editorData" (change)="onChange($event)">
    
                </ckeditor>
                <div class="buttons">
                  <a class="button is-dark" (click)="cancelComment()">
                    cancel
                  </a>
                  <a class="button is-dark" (click)="updateComment(comment._id)">
                    update
                  </a>
                </div>
              </div>
              <div *ngIf="comment?._id === newloadid">
                  <ckeditor [editor]="Editor" (change)="replyData($event)">
    
                  </ckeditor>
                  <div class="buttons">
                      <a class="button is-dark" (click)="cancelComment()">
                        cancel
                      </a>
                      <a class="button is-dark" (click)="sendReply(comment._id)">
                        Submit
                      </a>
                    </div>
              </div>
          </ng-template>

         

          <div *ngFor="let reply of comment?.replies">
            <div *ngIf="reply == null; else showThis">
              <div class="card replies_card">
                <div class="card-content">
                  <div class="control">
                    <input class="input" type="text" placeholder="reply unavailable" disabled>
                  </div>
                </div>
              </div>
            </div>

            <ng-template #showThis>
              <div class="card replies_card">
                <div class="card-content">
                  <div class="media">
                    <div class="media-left">
                      <figure class="image is-32x32">
                        <img src="https://bulma.io/images/placeholders/96x96.png" alt="Placeholder image"
                          class="is-rounded">
                      </figure>
                    </div>
                    <div class="media-content">
                      <div class="content">
                        <p class="has-text-weight-light is-size-6 c_a">{{reply.author? reply.author: 'Anonymous'}}</p>
                        <time datetime="" class="has-text-weight-light is-size-6">{{post.date | date : 'MMM dd'}}</time>
                      </div>
                    </div>
                    <div class="media-right">
                      <i class="fa fa-ellipsis-v"></i>
                    </div>
                  </div>
                  <div class="content" [innerHTML]="reply.text">

                  </div>
                  <div class="">
                    <div class="level is-mobile">
                      <div class="level-left">
                        <div class="level-item">
                          <a>
                            <span class="icon">
                              <i class="fas fa-heart has-text-danger"></i>
                            </span>
                            <span>0</span>
                          </a>
                        </div>
                      </div>
                      <div class="level-right">
                        <div class="level-item">
                          <a>
                            Delete
                          </a>
                        </div>
                        <div class="level-item">
                          <a>
                            Edit
                          </a>
                        </div>
                        <div class="level-item">
                          <a>Reply</a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </ng-template>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<footer class="footer">
  <div class="content has-text-centered">
    <p>
      Shredder et Ralty
    </p>
  </div>
</footer>